<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MVP QR Page</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-screen bg-gray-100 flex items-center justify-center">

  <div class="bg-white shadow-lg rounded-xl p-6 w-full max-w-sm">
    <h1 id="welcomeText" class="text-2xl font-bold text-center mb-6">
      Welcome
    </h1>

    <!-- Input container for name -->
    <div id="nameInputContainer" class="mb-4 text-center hidden">
      <input
        type="text"
        id="nameInput"
        placeholder="Enter vehicle no"
        class="border border-gray-300 rounded-lg px-3 py-2 w-full"
      />
      <button
        id="nameSubmitBtn"
        class="mt-3 bg-blue-500 text-white py-2 px-4 rounded-lg"
      >
        Continue
      </button>
    </div>

    <!-- Radio buttons form -->
    <form id="choiceForm" class="space-y-4 hidden">
      <div class="flex items-center space-x-3">
        <input type="radio" id="option1" name="choice" value="option1" class="w-4 h-4" />
        <label for="option1" class="text-gray-700">Wrongly parked- move it</label>
      </div>

      <div class="flex items-center space-x-3">
        <input type="radio" id="option2" name="choice" value="option2" class="w-4 h-4" />
        <label for="option2" class="text-gray-700">Rash driving</label>
      </div>

      <button
        type="submit"
        id="submitBtn"
        disabled
        class="w-full bg-blue-500 text-white py-2 rounded-lg opacity-50 cursor-not-allowed"
      >
        Submit
      </button>
    </form>

    <p id="resultText" class="text-green-600 text-center mt-4 hidden"></p>
  </div>

  <script>
    // 1. Extract name from URL query
    const params = new URLSearchParams(window.location.search);
    let name = params.get("name");

    const welcomeText = document.getElementById("welcomeText");
    const nameInputContainer = document.getElementById("nameInputContainer");
    const choiceForm = document.getElementById("choiceForm");

    function showRadioForm(displayName) {
      welcomeText.innerText = `Welcome ${displayName}`;
      choiceForm.classList.remove("hidden");
    }

    if (name && name.trim() !== "") {
      // Name from URL present
      name = name.trim();
      const displayName = name.charAt(0).toUpperCase() + name.slice(1);
      showRadioForm(displayName);
    } else {
      // Name not present â†’ show input box
      nameInputContainer.classList.remove("hidden");

      document.getElementById("nameSubmitBtn").addEventListener("click", () => {
        const inputName = document.getElementById("nameInput").value.trim();
        if (inputName === "") {
          alert("Please enter your name");
          return;
        }
        const displayName = inputName.charAt(0).toUpperCase() + inputName.slice(1);
        nameInputContainer.classList.add("hidden");
        showRadioForm(displayName);
      });
    }

    // 2. Enable submit only after radio selection
    const radios = document.querySelectorAll('input[name="choice"]');
    const submitBtn = document.getElementById("submitBtn");

    radios.forEach(radio => {
      radio.addEventListener("change", () => {
        submitBtn.disabled = false;
        submitBtn.classList.remove("opacity-50", "cursor-not-allowed");
      });
    });

    // 3. Handle submit
    choiceForm.addEventListener("submit", function (e) {
      e.preventDefault();
      const selected = document.querySelector('input[name="choice"]:checked');
      if (!selected) return;

      document.getElementById("resultText").innerText =
        `Thanks ${name.charAt(0).toUpperCase() + name.slice(1)}, you selected ${selected.value}`;
      document.getElementById("resultText").classList.remove("hidden");
      submitBtn.disabled = true;
    });
  </script>

</body>
</html>
